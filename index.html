<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSight Pro - Advanced Website Analyzer</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        #urlInput:focus {
            outline: none;
            border-color: #667eea !important;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .loading {
            text-align: center;
            padding: 80px 40px;
            display: none;
            background: white;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f1f5f9;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .results {
            display: none;
            background: #f8fafc;
        }
        
        .results-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .results-content {
            padding: 40px;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .metric-score {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 15px 0 8px 0;
        }
        
        .report-section {
            background: white;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        .section-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 30px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            flex: 1;
            margin-left: 15px;
        }
        
        .section-content {
            padding: 30px;
            display: none;
        }
        
        .section-content.active {
            display: block;
        }
        
        .error {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border: 1px solid #fca5a5;
            color: #991b1b;
            padding: 30px;
            border-radius: 16px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid { 
                grid-template-columns: 1fr; 
            }
            h1 {
                font-size: 2.5rem !important;
            }
        }
    </style>
</head>
<body>    
    <!-- Navigation Header -->
    <nav style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(0,0,0,0.1); position: fixed; top: 0; left: 0; right: 0; z-index: 1000; padding: 0 20px;">
        <div style="max-width: 1200px; margin: 0 auto; display: flex; align-items: center; justify-content: space-between; height: 70px;">
            <div style="display: flex; align-items: center;">
                <div style="background: linear-gradient(135deg, #667eea, #764ba2); width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; margin-right: 12px;">
                    <i class="fas fa-chart-line" style="color: white; font-size: 18px;"></i>
                </div>
                <span style="font-size: 1.5rem; font-weight: 700; color: #1e293b;">WebSight Pro</span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div style="min-height: 100vh; background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #f1f5f9 100%); padding-top: 70px; position: relative; overflow: hidden;">
        <!-- Decorative Elements -->
        <div style="position: absolute; top: 10%; left: 5%; width: 100px; height: 100px; background: linear-gradient(135deg, #667eea20, #764ba220); border-radius: 50%; opacity: 0.6;"></div>
        <div style="position: absolute; top: 20%; right: 10%; width: 150px; height: 150px; background: linear-gradient(135deg, #f59e0b20, #d9770620); border-radius: 30px; transform: rotate(45deg); opacity: 0.4;"></div>
        <div style="position: absolute; bottom: 20%; left: 10%; width: 80px; height: 80px; background: linear-gradient(135deg, #10b98120, #05966920); border-radius: 20px; opacity: 0.5;"></div>
        
        <div style="max-width: 1200px; margin: 0 auto; padding: 100px 20px 50px; text-align: center; position: relative; z-index: 2;">
            <!-- Main Headline -->
            <h1 style="font-size: 4rem; font-weight: 800; color: #1e293b; margin-bottom: 30px; line-height: 1.1;">
                A Website Analyzer Built For
                <br>
                <span style="background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    Developers Who Ship
                </span>
            </h1>
            
            <!-- Subtitle -->
            <p style="font-size: 1.3rem; color: #64748b; margin-bottom: 50px; max-width: 700px; margin-left: auto; margin-right: auto; line-height: 1.6;">
                AI-powered platform delivering comprehensive SEO audits, grammar analysis, and performance insights in seconds.
            </p>
            
            <!-- CTA Section -->
            <div style="background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto 60px; border: 1px solid rgba(0,0,0,0.05);">
                <div style="display: flex; gap: 15px; margin-bottom: 20px; align-items: stretch;">
                    <div style="flex: 1; position: relative;">
                        <i class="fas fa-globe" style="position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: #94a3b8; font-size: 18px;"></i>
                        <input 
                            type="url" 
                            placeholder="Enter your website URL (e.g., https://example.com)"
                            id="urlInput"
                            style="width: 100%; padding: 18px 20px 18px 55px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px; transition: all 0.3s ease; background: #f8fafc;"
                        >
                    </div>
                    <button onclick="analyzeWebsite()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 18px 30px; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; white-space: nowrap;">
                        <i class="fas fa-rocket" style="margin-right: 8px;"></i>
                        Analyze Now
                    </button>
                </div>
                
                <div style="display: flex; align-items: center; justify-content: center; gap: 20px; color: #64748b; font-size: 0.9rem;">
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-check-circle" style="color: #10b981; margin-right: 6px;"></i>
                        Free Analysis
                    </div>
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-clock" style="color: #10b981; margin-right: 6px;"></i>
                        Results in 10 seconds
                    </div>
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-shield-alt" style="color: #10b981; margin-right: 6px;"></i>
                        No signup required
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div style="background: white; padding: 100px 20px;">
        <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
            <h2 style="font-size: 2.5rem; font-weight: 700; color: #1e293b; margin-bottom: 20px;">
                Everything You Need to Optimize Your Website
            </h2>
            <p style="font-size: 1.1rem; color: #64748b; margin-bottom: 60px; max-width: 600px; margin-left: auto; margin-right: auto;">
                Comprehensive analysis powered by advanced AI to help you improve SEO, content quality, and user experience.
            </p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 40px;">
                <div class="feature-card" style="text-align: left; padding: 30px; border-radius: 16px; border: 1px solid #e2e8f0; transition: all 0.3s ease; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);">
                    <div style="background: linear-gradient(135deg, #3b82f6, #1d4ed8); width: 60px; height: 60px; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                        <i class="fas fa-search-plus" style="color: white; font-size: 24px;"></i>
                    </div>
                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #1e293b; margin-bottom: 12px;">SEO Analysis</h3>
                    <p style="color: #64748b; line-height: 1.6; margin: 0;">Complete SEO audit with keyword analysis, meta tag optimization, and search engine visibility recommendations.</p>
                </div>
                
                <div class="feature-card" style="text-align: left; padding: 30px; border-radius: 16px; border: 1px solid #e2e8f0; transition: all 0.3s ease; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);">
                    <div style="background: linear-gradient(135deg, #f59e0b, #d97706); width: 60px; height: 60px; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                        <i class="fas fa-spell-check" style="color: white; font-size: 24px;"></i>
                    </div>
                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #1e293b; margin-bottom: 12px;">Grammar & Content</h3>
                    <p style="color: #64748b; line-height: 1.6; margin: 0;">AI-powered grammar checking, readability analysis, and content quality assessment with specific improvement suggestions.</p>
                </div>
                
                <div class="feature-card" style="text-align: left; padding: 30px; border-radius: 16px; border: 1px solid #e2e8f0; transition: all 0.3s ease; background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%);">
                    <div style="background: linear-gradient(135deg, #8b5cf6, #7c3aed); width: 60px; height: 60px; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                        <i class="fas fa-tachometer-alt" style="color: white; font-size: 24px;"></i>
                    </div>
                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #1e293b; margin-bottom: 12px;">Performance Metrics</h3>
                    <p style="color: #64748b; line-height: 1.6; margin: 0;">Technical performance analysis including page speed, mobile optimization, and accessibility compliance.</p>
                </div>
                
                <div class="feature-card" style="text-align: left; padding: 30px; border-radius: 16px; border: 1px solid #e2e8f0; transition: all 0.3s ease; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);">
                    <div style="background: linear-gradient(135deg, #10b981, #059669); width: 60px; height: 60px; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px;">
                        <i class="fas fa-chart-line" style="color: white; font-size: 24px;"></i>
                    </div>
                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #1e293b; margin-bottom: 12px;">Actionable Insights</h3>
                    <p style="color: #64748b; line-height: 1.6; margin: 0;">Prioritized recommendations with clear action items and expected impact on your website's performance.</p>
                </div>
            </div>
        </div>
    </div>
        
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <h3 id="loadingTitle">Analyzing Your Website</h3>
        <p id="loadingMessage">Our AI is examining every aspect of your site. This will take just a few seconds...</p>
    </div>
    
    <div class="results" id="results">
        <div class="results-header">
            <h2><i class="fas fa-chart-pie"></i> Analysis Complete</h2>
            <p id="analysisUrl"></p>
        </div>
        <div class="results-content">
            <div id="reportContent"></div>
        </div>
    </div>

    <script>
        async function analyzeWebsite() {
            const urlInput = document.getElementById('urlInput');
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('Please enter a valid URL');
                return;
            }
            
            // Validate URL format
            try {
                new URL(url);
            } catch {
                alert('Please enter a valid URL format (e.g., https://example.com)');
                return;
            }
            
            // Scroll to results area
            document.getElementById('loading').scrollIntoView({ behavior: 'smooth' });
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            document.querySelector('button[onclick="analyzeWebsite()"]').disabled = true;
            
            try {
                const startTime = Date.now();
                // Determine the API endpoint based on environment
                const apiEndpoint = window.location.hostname.includes('netlify') 
                    ? '/.netlify/functions/analyze'  // Netlify endpoint
                    : window.location.hostname.includes('leap') 
                    ? '/api/analyze'  // Leap Cell endpoint
                    : '/api/analyze'; // Local development
                
                const response = await fetch(apiEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ url })
                });
                
                console.log('Response status:', response.status);
                console.log('Response ok:', response.ok);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                const analysisTime = ((Date.now() - startTime) / 1000).toFixed(1);
                
                console.log('Raw response data:', data);
                console.log('Response keys:', Object.keys(data));
                
                window.lastAnalysisTime = analysisTime;
                displayResults(data);
                
            } catch (error) {
                console.error('Analysis error:', error);
                displayError('Network error: ' + error.message);
            } finally {
                document.getElementById('loading').style.display = 'none';
                document.querySelector('button[onclick="analyzeWebsite()"]').disabled = false;
            }
        }
        
        function displayResults(data) {
            console.log('Received data:', data);
            
            // Check if this is an error response
            if (data.error) {
                displayError(data.error + (data.details ? ': ' + data.details : ''));
                return;
            }
            
            document.getElementById('analysisUrl').textContent = `Analysis for: ${data.url || 'Unknown'}`;
            
            const reportContent = document.getElementById('reportContent');
            
            // Extract data from API response
            const metrics = data.performanceMetrics || {};
            const scraped = data.scrapedData || {};
            const structured = data.structuredReport || {};
            

            
            // Build comprehensive display
            reportContent.innerHTML = buildDashboard(metrics) + 
                                    buildWebsiteOverview(scraped) +
                                    buildSEOAnalysis(structured.seoRecommendations) +
                                    buildTechnicalAnalysis(structured.technicalAnalysis) +
                                    buildContentAnalysis(structured.contentAnalysis) +
                                    buildActionPlan(structured.actionPlan) +
                                    buildKeywordAnalysis(structured.seoRecommendations?.contentSEO) +
                                    buildInsightsSection(data);
            
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function buildDashboard(metrics) {
            const overallScore = metrics.overall || 0;
            const seoScore = metrics.seo || 0;
            const contentScore = metrics.content || 0;
            const technicalScore = metrics.technical || 0;
            
            return `
                <div class="dashboard-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div class="metric-card" style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; border-left: 4px solid #3b82f6;">
                        <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                            <i class="fas fa-search" style="font-size: 24px; color: #3b82f6; margin-right: 12px;"></i>
                            <h3 style="margin: 0; color: #1e293b;">SEO Score</h3>
                        </div>
                        <div style="font-size: 2.5rem; font-weight: bold; margin: 15px 0 8px 0; color: ${getScoreColor(seoScore)};">${seoScore}/100</div>
                        <div style="color: #64748b; font-size: 0.9rem;">Search optimization level</div>
                    </div>
                    
                    <div class="metric-card" style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; border-left: 4px solid #f59e0b;">
                        <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                            <i class="fas fa-spell-check" style="font-size: 24px; color: #f59e0b; margin-right: 12px;"></i>
                            <h3 style="margin: 0; color: #1e293b;">Content Quality</h3>
                        </div>
                        <div style="font-size: 2.5rem; font-weight: bold; margin: 15px 0 8px 0; color: ${getScoreColor(contentScore)};">${contentScore}/100</div>
                        <div style="color: #64748b; font-size: 0.9rem;">Grammar & readability</div>
                    </div>
                    
                    <div class="metric-card" style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; border-left: 4px solid #8b5cf6;">
                        <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                            <i class="fas fa-cogs" style="font-size: 24px; color: #8b5cf6; margin-right: 12px;"></i>
                            <h3 style="margin: 0; color: #1e293b;">Technical</h3>
                        </div>
                        <div style="font-size: 2.5rem; font-weight: bold; margin: 15px 0 8px 0; color: ${getScoreColor(technicalScore)};">${technicalScore}/100</div>
                        <div style="color: #64748b; font-size: 0.9rem;">Technical performance</div>
                    </div>
                    
                    <div class="metric-card" style="background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; border-left: 4px solid #10b981;">
                        <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 15px;">
                            <i class="fas fa-chart-bar" style="font-size: 24px; color: #10b981; margin-right: 12px;"></i>
                            <h3 style="margin: 0; color: #1e293b;">Overall</h3>
                        </div>
                        <div style="font-size: 2.5rem; font-weight: bold; margin: 15px 0 8px 0; color: ${getScoreColor(overallScore)};">${overallScore}/100</div>
                        <div style="color: #64748b; font-size: 0.9rem;">Website health</div>
                    </div>
                </div>
            `;
        }

        function buildWebsiteOverview(scraped) {
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-globe"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">Website Overview</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content active" style="padding: 30px; display: block;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #3b82f6;">
                                <h4 style="color: #1e293b; margin: 0 0 10px 0;">Page Title</h4>
                                <p style="margin: 0; color: #374151; font-weight: 500;">${scraped.title || 'Not found'}</p>
                            </div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                                <h4 style="color: #1e293b; margin: 0 0 10px 0;">Word Count</h4>
                                <p style="margin: 0; color: #374151; font-weight: 500; font-size: 1.2rem;">${scraped.wordCount || 0} words</p>
                            </div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #8b5cf6;">
                                <h4 style="color: #1e293b; margin: 0 0 10px 0;">Images</h4>
                                <p style="margin: 0; color: #374151; font-weight: 500; font-size: 1.2rem;">${scraped.images?.length || 0} images</p>
                            </div>
                            <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #10b981;">
                                <h4 style="color: #1e293b; margin: 0 0 10px 0;">Links</h4>
                                <p style="margin: 0; color: #374151; font-weight: 500; font-size: 1.2rem;">${scraped.links?.length || 0} links</p>
                            </div>
                        </div>
                        ${scraped.metaDescription ? 
                            `<div style="background: #f0f9ff; padding: 20px; border-radius: 12px; border-left: 4px solid #3b82f6;">
                                <h4 style="color: #1e293b; margin: 0 0 10px 0;">Meta Description</h4>
                                <p style="margin: 0; color: #374151;">${scraped.metaDescription}</p>
                            </div>` : 
                            `<div style="background: #fef2f2; padding: 20px; border-radius: 12px; border-left: 4px solid #ef4444;">
                                <h4 style="color: #1e293b; margin: 0 0 10px 0;">‚ö†Ô∏è Missing Meta Description</h4>
                                <p style="margin: 0; color: #374151;">No meta description found. This is important for SEO.</p>
                            </div>`
                        }
                    </div>
                </div>
            `;
        }

        function buildSEOAnalysis(seoData) {
            const onPage = seoData?.onPageSEO || {};
            const contentSEO = seoData?.contentSEO || {};
            const technicalSEO = seoData?.technicalSEO || {};
            
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-search-plus"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">SEO Analysis</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content active" style="padding: 30px; display: block;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">On-Page SEO</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(onPage.score || 0)};">${onPage.score || 0}/100</span>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Title Length:</strong> ${onPage.titleAnalysis?.length || 0} characters
                                    ${onPage.titleAnalysis?.optimal ? ' ‚úÖ' : ' ‚ö†Ô∏è'}
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>H1 Tags:</strong> ${onPage.headingAnalysis?.h1Count || 0}
                                    ${onPage.headingAnalysis?.h1Count === 1 ? ' ‚úÖ' : ' ‚ö†Ô∏è'}
                                </div>
                                <div>
                                    <strong>Total Headings:</strong> ${onPage.headingAnalysis?.totalHeadings || 0}
                                </div>
                            </div>
                            
                            <div style="background: #f0fdf4; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">Content SEO</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(contentSEO.score || 0)};">${contentSEO.score || 0}/100</span>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Readability:</strong> <span style="color: ${getScoreColor(contentSEO.readability * 10 || 0)};">${contentSEO.readability || 0}/10</span>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Content Quality:</strong> <span style="color: ${getScoreColor(contentSEO.contentQuality * 10 || 0)};">${contentSEO.contentQuality || 0}/10</span>
                                </div>
                                <div>
                                    <strong>Word Count:</strong> ${contentSEO.wordCount || 0} words
                                </div>
                            </div>
                            
                            <div style="background: #fef3c7; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">Technical SEO</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(technicalSEO.score || 0)};">${technicalSEO.score || 0}/100</span>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Internal Links:</strong> ${technicalSEO.internalLinks || 0}
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>External Links:</strong> ${technicalSEO.externalLinks || 0}
                                </div>
                                <div>
                                    <strong>Image Alt Coverage:</strong> ${technicalSEO.imageOptimization?.altTextCoverage || 0}%
                                </div>
                            </div>
                        </div>
                        
                        ${onPage.issues?.length > 0 ? `
                            <div style="background: #fef2f2; padding: 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid #ef4444;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">‚ö†Ô∏è SEO Issues Found</h4>
                                <ul style="margin: 0; padding-left: 20px;">
                                    ${onPage.issues.map(issue => `<li style="color: #374151; margin-bottom: 5px;">${issue}</li>`).join('')}
                                </ul>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }
        
        function getScoreColor(score) {
            if (score >= 80) return '#10b981';
            if (score >= 60) return '#f59e0b';
            return '#ef4444';
        }

        function formatExecutiveSummary(summary, data) {
            console.log('Formatting executive summary with data:', data);
            const title = (data.scrapedData && data.scrapedData.title) ? data.scrapedData.title : 'Missing';
            const wordCount = (data.scrapedData && data.scrapedData.wordCount) ? data.scrapedData.wordCount : 0;
            const imageCount = (data.scrapedData && data.scrapedData.images) ? data.scrapedData.images.length : 0;
            const linkCount = (data.scrapedData && data.scrapedData.links) ? data.scrapedData.links.length : 0;
            
            console.log('Extracted values:', { title, wordCount, imageCount, linkCount });
            
            return '<div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #667eea; margin-bottom: 20px;">' +
                '<h4 style="color: #1e293b; margin-bottom: 15px;">Website Overview</h4>' +
                '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">' +
                    '<div><strong>Title:</strong> ' + title + '</div>' +
                    '<div><strong>Word Count:</strong> ' + wordCount + '</div>' +
                    '<div><strong>Images:</strong> ' + imageCount + '</div>' +
                    '<div><strong>Links:</strong> ' + linkCount + '</div>' +
                '</div>' +
            '</div>' +
            '<div style="line-height: 1.6; color: #374151;">' +
                (typeof summary === 'object' ? formatStructuredSummary(summary) : (summary || 'Analysis completed successfully. Your website has been thoroughly examined for SEO, content quality, and technical performance.')) +
            '</div>';
        }

        function formatStructuredSummary(summary) {
            if (!summary) return 'Analysis completed successfully.';
            return '<div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">' +
                '<h5 style="color: #1e293b; margin-bottom: 10px;">Analysis Summary</h5>' +
                '<p style="margin: 0; color: #374151;">' + (summary.overallAssessment || summary || 'Website analysis completed successfully.') + '</p>' +
            '</div>';
        }

        function generateTechnicalAnalysisHTML(technical) {
            return '<div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">' +
                '<h4 style="color: #1e293b; margin-bottom: 15px;">Technical Analysis</h4>' +
                '<p>Technical analysis completed. Your website has been evaluated for performance, accessibility, and technical SEO factors.</p>' +
            '</div>';
        }

        function generateSEORecommendationsHTML(seo) {
            return '<div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">' +
                '<h4 style="color: #1e293b; margin-bottom: 15px;">SEO Recommendations</h4>' +
                '<p>Your website has been analyzed for SEO optimization opportunities. Key areas for improvement include meta tags, content structure, and technical SEO elements.</p>' +
            '</div>';
        }

        function toggleSection(header) {
            console.log('Toggle section clicked');
            const content = header.nextElementSibling;
            const chevron = header.querySelector('.fa-chevron-down, .fa-chevron-up');
            
            console.log('Content element:', content);
            console.log('Current display:', content.style.display);
            console.log('Has active class:', content.classList.contains('active'));
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                content.style.display = 'none';
                if (chevron) {
                    chevron.classList.remove('fa-chevron-up');
                    chevron.classList.add('fa-chevron-down');
                }
            } else {
                content.classList.add('active');
                content.style.display = 'block';
                if (chevron) {
                    chevron.classList.remove('fa-chevron-down');
                    chevron.classList.add('fa-chevron-up');
                }
            }
        }

        function displayError(errorMessage) {
            const reportContent = document.getElementById('reportContent');
            reportContent.innerHTML = '<div class="error">' +
                '<i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 20px;"></i>' +
                '<h3>Analysis Failed</h3>' +
                '<p>' + errorMessage + '</p>' +
                '<p style="margin-top: 20px; font-size: 0.9rem;">Please check the URL and try again.</p>' +
            '</div>';
            
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function buildTechnicalAnalysis(techData) {
            if (!techData) return '';
            
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-cogs"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">Technical Analysis</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content" style="padding: 30px; display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">HTML Structure</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(techData.htmlStructure?.score || 0)};">${techData.htmlStructure?.score || 0}/100</span>
                                </div>
                                <div>
                                    <strong>Issues Found:</strong> ${techData.htmlStructure?.issues || 0}
                                </div>
                            </div>
                            
                            <div style="background: #f0fdf4; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">Page Speed</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(techData.pageSpeed?.score || 0)};">${techData.pageSpeed?.score || 0}/100</span>
                                </div>
                                <div>
                                    <strong>Load Time:</strong> ${techData.pageSpeed?.loadTime || 'Unknown'}
                                </div>
                            </div>
                            
                            <div style="background: #fef3c7; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">Mobile Optimization</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(techData.mobileOptimization?.score || 0)};">${techData.mobileOptimization?.score || 0}/100</span>
                                </div>
                                <div>
                                    <strong>Responsive:</strong> ${techData.mobileOptimization?.responsive ? '‚úÖ Yes' : '‚ùå No'}
                                </div>
                            </div>
                        </div>
                        
                        ${techData.issues?.length > 0 ? `
                            <div style="background: #fef2f2; padding: 20px; border-radius: 12px; border-left: 4px solid #ef4444;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">üîß Technical Issues</h4>
                                ${techData.issues.map(issue => `
                                    <div style="margin-bottom: 15px; padding: 15px; background: white; border-radius: 8px;">
                                        <div style="font-weight: 600; color: #ef4444; margin-bottom: 5px;">
                                            ${issue.type?.toUpperCase()} PRIORITY: ${issue.issue}
                                        </div>
                                        <div style="color: #374151; font-size: 0.9rem;">
                                            Impact: ${issue.impact}
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : ''}
                        
                        ${techData.recommendations?.length > 0 ? `
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 12px; margin-top: 20px; border-left: 4px solid #3b82f6;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">üí° Recommendations</h4>
                                <ul style="margin: 0; padding-left: 20px;">
                                    ${techData.recommendations.map(rec => `<li style="color: #374151; margin-bottom: 8px;">${rec}</li>`).join('')}
                                </ul>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function buildContentAnalysis(contentData) {
            if (!contentData) return '';
            
            const readability = contentData.readability || {};
            const quality = contentData.contentQuality || {};
            
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-file-alt"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">Content Analysis</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content" style="padding: 30px; display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">Readability</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Score:</strong> <span style="color: ${getScoreColor(readability.score || 0)};">${readability.score || 0}/100</span>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Level:</strong> ${readability.level || 'Unknown'}
                                </div>
                                <div>
                                    <strong>Errors:</strong> ${readability.errors?.length || 0}
                                </div>
                            </div>
                            
                            <div style="background: #f0fdf4; padding: 20px; border-radius: 12px;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">Content Quality</h4>
                                <div style="margin-bottom: 10px;">
                                    <strong>Word Count:</strong> ${quality.wordCount || 0}
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Uniqueness:</strong> ${quality.uniqueness || 0}%
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong>Engagement:</strong> ${quality.engagement || 0}%
                                </div>
                                <div>
                                    <strong>Reading Time:</strong> ~${quality.estimatedReadingTime || 0} min
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function buildActionPlan(actionData) {
            if (!actionData) return '';
            
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-tasks"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">Priority Action Plan</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content" style="padding: 30px; display: none;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                            ${actionData.highPriority?.length > 0 ? `
                                <div style="background: #fef2f2; padding: 20px; border-radius: 12px; border-left: 4px solid #ef4444;">
                                    <h4 style="color: #ef4444; margin: 0 0 15px 0;">üî¥ High Priority</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        ${actionData.highPriority.map(item => `<li style="color: #374151; margin-bottom: 8px;">${item}</li>`).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                            
                            ${actionData.mediumPriority?.length > 0 ? `
                                <div style="background: #fef3c7; padding: 20px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                                    <h4 style="color: #f59e0b; margin: 0 0 15px 0;">üü° Medium Priority</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        ${actionData.mediumPriority.map(item => `<li style="color: #374151; margin-bottom: 8px;">${item}</li>`).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                            
                            ${actionData.lowPriority?.length > 0 ? `
                                <div style="background: #f0fdf4; padding: 20px; border-radius: 12px; border-left: 4px solid #10b981;">
                                    <h4 style="color: #10b981; margin: 0 0 15px 0;">üü¢ Low Priority</h4>
                                    <ul style="margin: 0; padding-left: 20px;">
                                        ${actionData.lowPriority.map(item => `<li style="color: #374151; margin-bottom: 8px;">${item}</li>`).join('')}
                                    </ul>
                                </div>
                            ` : ''}
                        </div>
                        
                        ${actionData.estimatedImpact ? `
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 12px; border-left: 4px solid #3b82f6;">
                                <h4 style="color: #1e293b; margin: 0 0 15px 0;">üìä Estimated Impact</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                    <div>
                                        <strong>Time to Implement:</strong><br>
                                        <span style="color: #374151;">${actionData.estimatedImpact.timeToImplement || 'Unknown'}</span>
                                    </div>
                                    <div>
                                        <strong>Difficulty Level:</strong><br>
                                        <span style="color: #374151;">${actionData.estimatedImpact.difficultyLevel || 'Unknown'}</span>
                                    </div>
                                    <div>
                                        <strong>Expected ROI:</strong><br>
                                        <span style="color: #374151;">${actionData.estimatedImpact.expectedROI || 'Unknown'}</span>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function buildKeywordAnalysis(contentSEO) {
            if (!contentSEO?.keywords?.length) return '';
            
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-key"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">Keyword Analysis</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content" style="padding: 30px; display: none;">
                        <div style="background: #f8fafc; padding: 20px; border-radius: 12px;">
                            <h4 style="color: #1e293b; margin: 0 0 20px 0;">Top Keywords Found</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                ${contentSEO.keywords.slice(0, 10).map(keyword => `
                                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                                        <div style="font-weight: 600; color: #1e293b; margin-bottom: 5px;">${keyword.word}</div>
                                        <div style="color: #64748b; font-size: 0.9rem;">
                                            Count: ${keyword.count} | 
                                            Density: ${contentSEO.keywordDensity?.[keyword.word] || '0'}%
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function buildInsightsSection(data) {
            const metrics = data.performanceMetrics || {};
            const scraped = data.scrapedData || {};
            const seoData = data.structuredReport?.seoRecommendations || {};
            
            // Calculate insights
            const totalIssues = (metrics.issues?.technical || 0) + (metrics.issues?.seo || 0) + (metrics.issues?.content || 0);
            const avgScore = Math.round((metrics.overall + metrics.seo + metrics.content + metrics.technical) / 4);
            const topKeywords = seoData.contentSEO?.keywords?.slice(0, 3) || [];
            
            // Determine website health status
            let healthStatus = 'Excellent';
            let healthColor = '#10b981';
            let healthIcon = 'fa-check-circle';
            
            if (avgScore < 60) {
                healthStatus = 'Needs Improvement';
                healthColor = '#ef4444';
                healthIcon = 'fa-exclamation-triangle';
            } else if (avgScore < 80) {
                healthStatus = 'Good';
                healthColor = '#f59e0b';
                healthIcon = 'fa-info-circle';
            }
            
            return `
                <div class="report-section" style="background: white; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.08); overflow: hidden;">
                    <div class="section-header" onclick="toggleSection(this)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px 30px; display: flex; align-items: center; cursor: pointer;">
                        <i class="fas fa-lightbulb"></i>
                        <div style="font-size: 1.3rem; font-weight: 700; flex: 1; margin-left: 15px;">üí° Key Insights & Recommendations</div>
                        <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
                    </div>
                    <div class="section-content active" style="padding: 30px; display: block;">
                        <!-- Website Health Overview -->
                        <div style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); padding: 25px; border-radius: 16px; margin-bottom: 25px; border-left: 4px solid ${healthColor};">
                            <div style="display: flex; align-items: center; margin-bottom: 15px;">
                                <i class="fas ${healthIcon}" style="font-size: 24px; color: ${healthColor}; margin-right: 12px;"></i>
                                <h3 style="margin: 0; color: #1e293b;">Website Health: ${healthStatus}</h3>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px;">
                                <div><strong>Average Score:</strong> <span style="color: ${healthColor};">${avgScore}/100</span></div>
                                <div><strong>Total Issues:</strong> <span style="color: ${totalIssues > 5 ? '#ef4444' : '#10b981'};">${totalIssues}</span></div>
                                <div><strong>Content Length:</strong> ${scraped.wordCount || 0} words</div>
                                <div><strong>Page Elements:</strong> ${(scraped.images?.length || 0) + (scraped.links?.length || 0)} items</div>
                            </div>
                        </div>

                        <!-- Quick Wins -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 25px;">
                            <div style="background: #fef3c7; padding: 20px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                                <h4 style="color: #92400e; margin: 0 0 15px 0;">‚ö° Quick Wins</h4>
                                <ul style="margin: 0; padding-left: 20px; color: #374151;">
                                    ${!scraped.metaDescription ? '<li>Add meta description for better search visibility</li>' : ''}
                                    ${scraped.wordCount < 300 ? '<li>Expand content to at least 300 words</li>' : ''}
                                    ${(scraped.images?.filter(img => !img.hasAlt).length || 0) > 0 ? '<li>Add alt text to images for accessibility</li>' : ''}
                                    ${scraped.headings?.filter(h => h.level === 1).length !== 1 ? '<li>Use exactly one H1 tag per page</li>' : ''}
                                    ${scraped.wordCount >= 300 && scraped.metaDescription && (scraped.images?.filter(img => !img.hasAlt).length || 0) === 0 ? '<li>Great job! No quick wins needed.</li>' : ''}
                                </ul>
                            </div>
                            
                            <div style="background: #f0f9ff; padding: 20px; border-radius: 12px; border-left: 4px solid #3b82f6;">
                                <h4 style="color: #1e40af; margin: 0 0 15px 0;">üéØ Focus Areas</h4>
                                <ul style="margin: 0; padding-left: 20px; color: #374151;">
                                    ${metrics.seo < 80 ? '<li>Improve SEO optimization and keyword usage</li>' : ''}
                                    ${metrics.content < 70 ? '<li>Enhance content quality and readability</li>' : ''}
                                    ${metrics.technical < 80 ? '<li>Address technical performance issues</li>' : ''}
                                    ${metrics.seo >= 80 && metrics.content >= 70 && metrics.technical >= 80 ? '<li>Excellent performance across all areas!</li>' : ''}
                                </ul>
                            </div>
                        </div>

                        <!-- Top Keywords Performance -->
                        ${topKeywords.length > 0 ? `
                            <div style="background: #f0fdf4; padding: 20px; border-radius: 12px; border-left: 4px solid #10b981; margin-bottom: 25px;">
                                <h4 style="color: #166534; margin: 0 0 15px 0;">üîë Top Performing Keywords</h4>
                                <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                                    ${topKeywords.map(keyword => `
                                        <span style="background: white; padding: 8px 12px; border-radius: 20px; font-size: 0.9rem; color: #374151; border: 1px solid #d1fae5;">
                                            <strong>${keyword.word}</strong> (${keyword.count} uses)
                                        </span>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}

                        <!-- Performance Comparison -->
                        <div style="background: #f8fafc; padding: 20px; border-radius: 12px; border-left: 4px solid #6366f1;">
                            <h4 style="color: #4338ca; margin: 0 0 15px 0;">üìä Performance Breakdown</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: ${getScoreColor(metrics.seo)};">${metrics.seo}/100</div>
                                    <div style="color: #64748b; font-size: 0.9rem;">SEO Optimization</div>
                                    <div style="background: #e2e8f0; height: 4px; border-radius: 2px; margin-top: 8px;">
                                        <div style="background: ${getScoreColor(metrics.seo)}; height: 100%; width: ${metrics.seo}%; border-radius: 2px;"></div>
                                    </div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: ${getScoreColor(metrics.content)};">${metrics.content}/100</div>
                                    <div style="color: #64748b; font-size: 0.9rem;">Content Quality</div>
                                    <div style="background: #e2e8f0; height: 4px; border-radius: 2px; margin-top: 8px;">
                                        <div style="background: ${getScoreColor(metrics.content)}; height: 100%; width: ${metrics.content}%; border-radius: 2px;"></div>
                                    </div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 1.5rem; font-weight: bold; color: ${getScoreColor(metrics.technical)};">${metrics.technical}/100</div>
                                    <div style="color: #64748b; font-size: 0.9rem;">Technical Performance</div>
                                    <div style="background: #e2e8f0; height: 4px; border-radius: 2px; margin-top: 8px;">
                                        <div style="background: ${getScoreColor(metrics.technical)}; height: 100%; width: ${metrics.technical}%; border-radius: 2px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Next Steps -->
                        <div style="background: linear-gradient(135deg, #fef7ff 0%, #f3e8ff 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #8b5cf6;">
                            <h4 style="color: #7c3aed; margin: 0 0 15px 0;">üöÄ Recommended Next Steps</h4>
                            <ol style="margin: 0; padding-left: 20px; color: #374151;">
                                <li style="margin-bottom: 8px;">Address high-priority issues first for maximum impact</li>
                                <li style="margin-bottom: 8px;">Focus on the lowest-scoring area (${
                                    metrics.seo <= metrics.content && metrics.seo <= metrics.technical ? 'SEO' :
                                    metrics.content <= metrics.technical ? 'Content Quality' : 'Technical Performance'
                                })</li>
                                <li style="margin-bottom: 8px;">Re-analyze after implementing changes to track progress</li>
                                <li>Consider professional SEO tools for deeper analysis</li>
                            </ol>
                        </div>
                    </div>
                </div>
            `;
        }    
</script>
</body>
</html>